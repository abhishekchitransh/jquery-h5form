/**
 * jQuery h5form 2.4 by http://www.rapidexp.com/h5form
 * compressed using YUI Compressor 2.4.2 with disableOpt
 */
(function(a){a.fn.h5form=function(e){a.fn.outerHTML=function(){var G=a(this).get(0);return G.outerHTML||new XMLSerializer().serializeToString(G)};var n={classResponse:"h5form-response",classSpinNumber:"h5form-spinNumber",classSpinTime:"h5form-spinTime",classRange:"h5form-range",classDatetime:"h5form-datetime",colorOff:"#a1a1a1",colorErr:"mistyrose",emptyMessage:"このフィールドを入力してください。",unselectedMessage:"リスト内の項目を選択してください。",emailMessage:"メールアドレスが正しくありません。",urlMessage:"URLが正しくありません。",patternMessage:"必用なパターンに一致していません。",invalidMessage:"値が無効です。",minMessage:"# 以上にしてください。",maxMessage:"# 以下にしてください。",maxlengthMessage:"指定の文字数上限より # 文字多いです。",dynamicHtml:false};var q=a.extend({},n,e);var h=parseInt(a.browser.version),y=a("<input>").hide().appendTo(a("body")).get(0),x=a("textarea:first").get(0)||new Object(),v=a("button:first").get(0)||new Object(),z=("setCustomValidity" in y),D=(a.browser.webkit&&h>=533),s=("autofocus" in y),C=("required" in y),b=("placeholder" in y),F=("pattern" in y),f=hasUrl=z&&F,r=hasRange=("step" in y)&&("min" in y),A=(a.browser.opera&&h>9),t=("maxLength" in x),o=("formAction" in v),B=(a.browser.msie&&h<9);a("input:last").remove();a("body").click(function(){a("."+q.classResponse).remove()});return this.each(function(){var L=a(this),K,M=new Array(),I=new Object(),H=":input:enabled:not(:button, :submit, :radio, :checkbox, :hidden)",J=L.find(H),G=!!L.outerHTML().match(/^[^>]+ novalidate/);a.fn.setCustomValidity=function(N,P){if(G){P=null}var Q=a(this);if(Q.is(H)){if(!D&&P&&(title=Q.attr("title"))){P+="\n"+title}if(z){Q.get(0).setCustomValidity(P)}else{var O=Q.get(0).tabIndex;if(P){N[O]=new Array(Q,P.replace(/\n/,"<br />"));Q.css("backgroundColor",q.colorErr)}else{N[O]=null;Q.css("backgroundColor","")}}}return Q};a.fn.spin=function(O){var T=a(this),P=(T.attr("type").toLowerCase()=="number"),Q=i(T,"min",(P)?"":0),N=i(T,"max",(P)?"":86400),R=i(T,"step",(P)?1:60),S=(P)?Q:0,U=(P)?Number(T.val()):p(T.val(),true);U=U-((U-S)%R)+R*((O)?-1:1);if(N!=""&&U>N){U=N}if(Q!=""&&U<Q){U=Q}T.val((P)?U:w(U,R%60,true));return T};a.fn.initControl=function(){return this.each(function(){var aa=a(this),Y=aa.attr("type"),ab=aa.attr("placeholder");if(Y){Y=Y.toLowerCase()}if(!s&&!K&&aa.attr("autofocus")){K=aa}if(!b&&ab&&Y!="password"){M.push(aa);var ac=(function(){if(aa.val()==ab){aa.attr("value","").css("color","")}});aa.unbind("focus",ac).focus(ac);var R=(function(){if(aa.val()==""||aa.val()==ab){aa.val(ab).css("color",q.colorOff)}});aa.unbind("blur",R).blur(R).blur()}if((!r&&Y=="number")||(!A&&Y=="time")){var ad=(Y=="number"),W=(ad)?q.classSpinNumber:q.classSpinTime,N=[8,9,35,36,37,39,46].concat((ad)?[190]:[59,186,190]);var V=(function(ae){var af=ae.charCode||ae.keyCode;if(af==38){aa.spin(0)}if(af==40){aa.spin(1)}if((a.inArray(af,N)>=0)||(af>=48&&af<=57)){return true}return false});aa.unbind("keydown",V).keydown(V).after('<span class="'+W+'">'+'<button type="button">&and;</button>'+'<button type="button">&or;</button></span>');aa.next().children().click(function(){aa.spin(aa.next().children().index(a(this))).change()})}if(!A&&(Y=="date")&&("datepicker" in aa)){var U={dateFormat:"yy-mm-dd"};if(aa.attr("min")!=undefined){U.minDate=aa.attr("min")}if(aa.attr("max")!=undefined){U.maxDate=aa.attr("max")}aa.datepicker(U)}if(!hasRange&&(Y=="range")&&("slider" in aa)){var S=i(aa,"min",0),Z=i(aa,"max",100),P=i(aa,"step",1),O=i(aa,"val",(S+Z)/2-((S+Z)/2%P));aa.hide().after('<span class="'+q.classRange+'"><div></div></span>').val(O);aa.next().children().slider({min:S,max:Z,step:P,value:O,change:function(af,ae){aa.val(a(this).slider("value"))}})}if(!t&&aa.is("textarea")&&(maxlength=aa.attr("maxlength"))){var T=(function(ae){var af=ae.charCode||ae.keyCode;if((a.inArray(af,[8,9,37,39,46])<0)&&(this.value.length>=maxlength)){return false}return true});aa.unbind("keypress",T).keypress(T)}if(!A&&(Y=="datetime"||Y=="datetime-local")){if(!aa.next().hasClass(q.classDatetime)){var O=m(aa.val()),S=m(aa.attr("min")),Z=m(aa.attr("max")),Q=(Y=="datetime")?'<span class="h5form-timezone">'+l()+"</span>":"";aa.hide().after('<span class="'+q.classDatetime+'">'+'<input type="date" value="'+O[0]+'" min="'+S[0]+'" max="'+Z[0]+'"'+' size="'+aa.attr("size")+'" class="'+aa.attr("class")+'" title="'+aa.attr("title")+'">'+'<input type="time" value="'+O[1]+'" step="'+i(aa,"step",60)+'"'+' size="'+aa.attr("size")+'" class="'+aa.attr("class")+'" title="'+aa.attr("title")+'">'+Q+"</span>").next().children().initControl()}}var X=(function(){var ak=false,am=(aa.val()==""||(ab&&aa.val()==ab));aa.setCustomValidity(I,null);if(!C&&aa.attr("required")){ak=true;if(am){aa.setCustomValidity(I,(aa.is("select"))?q.unselectedMessage:q.emptyMessage);return true}}if(!F&&(ap=aa.attr("pattern"))){ak=true;if(!am&&u(aa,"^("+ap.replace(/^\^?(.*)\$?$/,"$1")+")$")){aa.setCustomValidity(I,q.patternMessage);return true}}if(!f&&Y=="email"){ak=true;if(!am&&u(aa,"[\\w-\\.]{3,}@([\\w-]{2,}\\.)*([\\w-]{2,}\\.)[\\w-]{2,4}","i")){aa.setCustomValidity(I,q.emailMessage);return true}}if(!hasUrl&&Y=="url"){ak=true;if(!am&&u(aa,"[\\w-\\.]{3,}:\\/\\/([\\w-]{2,}\\.)*([\\w-]{2,}\\.)[\\w-]{2,4}","i")){aa.setCustomValidity(I,q.urlMessage);return true}}if(!t&&aa.is("textarea")&&aa.attr("maxlength")){ak=true;if(over=j(aa)){aa.setCustomValidity(I,q.maxlengthMessage.replace(/#/,over));return true}}if((!r&&Y=="number")||(!A&&(Y=="date"||Y=="time"))){ak=true;var ar=aa,ao=Y,aq=aa;if(aa.parent().hasClass(q.classDatetime)){ar=aa.parent().prev();ao=ar.attr("type").toLowerCase();aq=aa.parent().children();aq.setCustomValidity(I,"");var an=aq.index(aa),aj=aq.eq(0).val(),ai=aq.eq(1).val();if(aj!=""||ai!=""){if(aj==""||ai==""){var al=m(ar.attr("min"),true);if(an==0&&aj!=""&&ai==""){aq.eq(1).val(al[1])}if(an==1&&ai!=""&&aj==""){aq.eq(0).val(al[0])}aj=aq.eq(0).val(),ai=aq.eq(1).val()}var ah=a.trim(aj+"T"+ai);if(ao=="datetime-local"){ar.val(ah)}else{var af=g(ah);ar.val(af[0]+"T"+af[1])}}else{ar.val("")}}var ap,al,ag;switch(ao){case"number":ap="^-?\\d+\\.?\\d*$";al=0;ag=1;break;case"date":ap="^\\d+-\\d+-\\d+$";al="1970-01-01";ag=1;break;case"time":ap="^\\d+:\\d+:?\\d*\\.?\\d*$";al="00:00";ag=60;break;case"datetime":ap="^\\d+-\\d+-\\d+T\\d+:\\d+:?\\d*\\.?\\d*Z$";al="1970-01-01T00:00";ag=60;break;case"datetime-local":ap="^\\d+-\\d+-\\d+T\\d+:\\d+:?\\d*\\.?\\d*$";al="1970-01-01T00:00";ag=60;break}if(u(ar,ap)||(k(ar,al,ag))){aq.setCustomValidity(I,q.invalidMessage);return true}if(c(ar)){aq.setCustomValidity(I,q.minMessage.replace(/#/,ar.attr("min")));return true}if(d(ar)){aq.setCustomValidity(I,q.maxMessage.replace(/#/,ar.attr("max")));return true}}if(B&&!aa.is("select, textarea, button")){var ae=(function(at){var au=at.charCode||at.keyCode;if(au==13){L.find("input:submit, button:submit").eq(0).click();return false}return true});aa.unbind("keypress",ae).keypress(ae);ak=true}return ak});if(X()){aa.unbind("change",X).change(X)}})};J.initControl();if(K){K.focus().select()}L.find("input:submit, input:image, input:button, button:submit").click(function(){var R=a(this);if(!o){if(attr=R.attr("form")){L=a("#"+attr);B=true}if(attr=R.attr("formaction")){L.attr("action",attr)}if(attr=R.attr("formeenctype")){L.attr("enctype",attr)}if(attr=R.attr("formmethod")){L.attr("method",attr)}if(attr=R.attr("formtarget")){L.attr("target",attr)}if(attr=R.attr("formnovalidate")){L.attr("novalidate",attr);if(attr=="novalidate"){J.each(function(){a(this).setCustomValidity(I,"")})}}}if(q.dynamicHtml){L.find(q.dynamicHtml).initControl()}if(!z){var O;for(var N in I){if(I[N]&&(O==null||O>N)){O=N}}if(O!=null){var Q=I[O][0],P=I[O][1];if(!Q.prev().hasClass(q.classResponse)){Q.before('<span class="'+q.classResponse+'"></span>')}Q.prev().html("<p>"+P.replace(/\n/,"<br/>")+"</p>");Q.focus().select();return false}}if(!b){for(var O in M){if(O!=undefined){var S=M[O];if(S.val()==S.attr("placeholder")){S.val("")}}}}if(B){a('<input type="hidden" name="'+R.attr("name")+'" value="'+R.val()+'">').appendTo(L);L.find("button, input:submit").attr("name","");if(R.is("button")){L.find("input:submit").remove()}L.submit();return false}})});function u(H,I,G){re=new RegExp(I,G);return((H.val()!="")&&H.val().search(re))}function k(I,G,H){G=(I.attr("type").toLowerCase().indexOf("datetime"))?i(I,"min",G):i(I,"",G);H=i(I,"step",H);var J=i(I,"val","");return((J!="")&&((J-G)%H))}function c(H){var I=i(H,"val",""),G=i(H,"min","");return((I!="")&&(G!="")&&(I<G))}function d(H){var I=i(H,"val",""),G=i(H,"max","");return((I!="")&&(G!="")&&(I>G))}function j(I){var H=I.val().length,G=i(I,"maxlength",0);return(H&&G&&(H>G))?H-G:0}function i(H,G,I){var J=(G)?((G=="val")?H.val():H.attr(G)):I;if(J==undefined||J==""){J=""+I}if(J.match(/\d+-\d+-\d+[ T]\d+:\d/)){return Date.parse(E(J))/(1000)}if(J.match(/\d+-\d+-\d+/)){return Date.parse(E(J))/(1000*60*60*24)}if(J.match(/\d+:\d/)){return p(J,true)}return Number(J)}function p(H,G){if(H.search(/\d+:\d+/)){H="00:00"}if(G){H+=" GMT"}return Date.parse("1970/1/1 "+H)/1000}function w(J,H,I){var G=new Date(J*1000);ret=(I)?G.toUTCString():toString();return ret.replace((H)?/.* (\d+:\d+:\d+).*$/:/.* (\d+:\d+).*$/,"$1")}function m(K,G){if(!K&&!G){return new Array("","")}var I=(!K)?new Date():new Date(E(K)),H=I.getFullYear()+"-"+(I.getMonth()+1)+"-"+I.getDate();H=H.replace(/\b(\d)\b/g,"0$1");var J=I.toString().replace(/.* (\d+:\d+:\d+).*$/,"$1");return new Array(H,J)}function g(J){var H=new Date(E(J)),G=H.getUTCFullYear()+"-"+(H.getUTCMonth()+1)+"-"+H.getUTCDate();G=G.replace(/\b(\d)\b/g,"0$1");var I=H.toUTCString().replace(/.* (\d+:\d+:\d+).*$/,"$1Z");return new Array(G,I)}function E(G){return G.replace(/-/g,"/").replace(/T/," ").replace(/Z/," GMT").replace(/([+-])(\d+):(\d+)/," GMT$1$2$3")}function l(){var I=new Date(),H=-1*I.getTimezoneOffset();if(H){var G=H/60+":"+H%60;return G.replace(/\b(\d)\b/g,"0$1").replace(/^(\d)/,"+$1")}else{return"UTC"}}}})(jQuery);
